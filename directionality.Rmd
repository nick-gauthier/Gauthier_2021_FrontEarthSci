---
title: "Directionality"
author: "Nick Gauthier"
date: "July 26, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidygraph)
library(ggraph)
```

```{r}
flow_mat <- matrix(c(0,	194, 96, 178,	66, 1500, 3641,
         96,	0,	34,	5467,	76,	12080,	7709,
         362,	132,	0,	144,	4998,	2470,	6580,
         40, 6124,	28,	0,	66,	8105,	4145,	
        134,	162,	3199,	201,	0,	3780,	9855,
        36,	1496,	32,	1350,	60,	0,	8795,
        6,	14,	0,	16,	0,	335,	0), 
       byrow = T, nrow = 7) 

dir <- as_tbl_graph(flow_mat, directed = T) %>%
  mutate(centrality = centrality_eigen(weights = weight))
```

```{r}
undir <- (flow_mat + t(flow_mat)) %>%
  as_tbl_graph(directed = F) %>%
  mutate(centrality = centrality_eigen(weights = weight))
```

```{r}
plt <- create_layout(dat_dir, layout = 'nicely')
ggraph(plt) +
  geom_edge_fan(aes(color = weight, alpha = weight, width = weight)) +
  geom_node_point(aes(size = centrality)) +
  scale_size_area() +
  scale_edge_colour_distiller(palette = 'Spectral') +
  theme_void() +
  ggtitle('Directed UK commuting flows') +
  theme(legend.position="none")
```


```{r}
ggraph(undir) +
  geom_edge_fan(aes(color = weight, alpha = weight, width = weight)) +
  geom_node_point(aes(size = centrality)) +
  scale_size_area() +
  scale_edge_colour_distiller(palette = 'Spectral') +
  theme_void() +
  ggtitle('Directed UK commuting flows') +
  theme(legend.position="none")
```

