geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void()
test.plot
test.plot <- ad1200 %>%
delete_edges(E(ad1200)[E(ad1200)$weight < .75]) %>%
ggraph('manual', node.positions = swsn.pts) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = 'white') +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point(aes(size = P1room)) +
scale_size_area() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void()
test.plot
swsn.layout <- ad1200 %>%
delete_edges(E(ad1200)[E(ad1200)$weight < .75]) %>%
create_layout('manual', node.positions = swsn.pts)
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = 'white') +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point(aes(size = P1room)) +
scale_size_area() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void()
swsn.layout <- ad1200 %>%
delete_edges(E(ad1200)[E(ad1200)$weight < .5]) %>%
create_layout('manual', node.positions = swsn.pts)
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = 'white') +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point(aes(size = P1room)) +
scale_size_area() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void()
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = 'white') +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point() +
scale_size_area() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void()
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = 'white') +
geom_edge_link(aes(alpha = weight, color = weight)) +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void()
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = 'white') +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point(aes(size = P1room)) +
scale_size_area() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void()
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = 'white') +
geom_edge_link(aes(alpha = weight, color = weight)) +
#scale_edge_color_viridis() +
scale_edge_color_distiller(direction = -1) +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = 'white') +
geom_edge_link(aes(alpha = weight, color = weight)) +
#scale_edge_color_viridis() +
scale_edge_color_distiller(direction = 1) +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight, color = weight)) +
#scale_edge_color_viridis() +
scale_edge_color_distiller(trans = 'log') +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
eofdat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(sp = T, na.rm = F)
eofdat
eofdat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
raster::as.data.frame(sp = T, na.rm = F)
eofdat
eofdat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
raster::as.data.frame(sp = T, na.rm = F)
eofdat
eofdat
eofdat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
raster::as.data.frame(xy = T, na.rm = F)
eofdat
test.plot + geom_raster(aes(x = x, y = y, fill = x3), data = eof.dat, na.rm = T, show.legend = F)
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
raster::as.data.frame(xy = T, na.rm = T)
test.plot + geom_raster(aes(x = x, y = y, fill = x3), data = eof.dat, na.rm = T, show.legend = F)
eof.dat
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(xy = T, na.rm = T)
ggraph(swsn.layout) +
geom_raster(aes(fill = x3), data = eof.dat, na.rm = T)
ggraph(swsn.layout) +
geom_raster(aes(fill = x3), data = eof.dat, na.rm = T) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
eof.dat
ggraph(swsn.layout) +
geom_raster(aes(fill = X3), data = eof.dat, na.rm = T) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
qplot(x, y, X3, dat = eof.dat, geom = 'raster' na.rm = T)
qplot(x, y, X3, dat = eof.dat, geom = 'raster', na.rm = T)
qplot(x, y, X3, dat = eof.dat, geom = 'raster')
qplot(x, y, fill = X3, dat = eof.dat, geom = 'raster')
qplot(x, y, fill = X3, dat = eof.dat, geom = 'raster') +
scale_fill_disiller(palette = 'RdBu')
qplot(x, y, fill = X3, dat = eof.dat, geom = 'raster') +
scale_fill_distiller(palette = 'RdBu')
qplot(x, y, fill = X3, dat = eof.dat, geom = 'raster') +
scale_fill_distiller(palette = 'RdBu', limits = c(-max(abs(X3)), max(abs(X3))))
max(abs(eof.dat$X3)))
max(abs(eof.dat$X3))
qplot(x, y, fill = X3, dat = eof.dat, geom = 'raster') +
scale_fill_distiller(palette = 'RdBu', limits = c(-.27, .27))
ggplot(eof.dat, aes(x, y, z = X3)) +
stat_contour(geom="polygon", aes(fill=..level..))
ggplot(eof.dat, aes(x, y, z = X3)) +
stat_contour(geom="polygon", aes(fill=..level..))
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(xy = T, na.rm = T) %>%
mutate(value = cut(X3, breaks=seq(0, max(dat$value), length.out=5)))
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(xy = T, na.rm = T) %>%
mutate(value = cut(X3, breaks=seq(0, max(X3), length.out=5)))
qplot(x, y, fill = X3, dat = eof.dat, geom = 'raster') +
scale_fill_distiller(palette = 'RdBu', limits = c(-.27, .27))
qplot(x, y, fill = value, dat = eof.dat, geom = 'raster') +
scale_fill_distiller(palette = 'RdBu', limits = c(-.27, .27))
qplot(x, y, fill = value, dat = eof.dat, geom = 'raster') +
scale_fill_brewer(palette = 'RdBu', limits = c(-.27, .27))
qplot(x, y, fill = value, dat = eof.dat, geom = 'raster') +
scale_fill_brewer(palette = 'RdBu')
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(xy = T, na.rm = T) %>%
mutate(value = cut(X3, breaks=seq(-max(abs(X3)), max(abs(X3)), length.out=5)))
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(xy = T, na.rm = T) %>%
mutate(value = cut(X3, breaks=seq(-max(abs(X3)), max(abs(X3)), length.out=5)))
qplot(x, y, fill = value, dat = eof.dat, geom = 'raster') +
scale_fill_brewer(palette = 'RdBu')
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(xy = T, na.rm = T) %>%
mutate(value = cut(X3, breaks=seq(-max(abs(X3)), max(abs(X3)), length.out=20)))
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(xy = T, na.rm = T) %>%
mutate(value = cut(X3, breaks=seq(-max(abs(X3)), max(abs(X3)), length.out=20)))
qplot(x, y, fill = value, dat = eof.dat, geom = 'raster') +
scale_fill_brewer(palette = 'RdBu')
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(xy = T, na.rm = T) %>%
mutate(value = cut(X3, breaks=seq(-max(abs(X3)), max(abs(X3)), length.out=11)))
eof.dat <- brick('Data/eof1200.nc')[[3]] %>%
mask(states.ply) %>%
as.data.frame(xy = T, na.rm = T) %>%
mutate(value = cut(X3, breaks=seq(-max(abs(X3)), max(abs(X3)), length.out=11)))
qplot(x, y, fill = value, dat = eof.dat, geom = 'raster') +
scale_fill_brewer(palette = 'RdBu')
ggraph(swsn.layout) +
geom_raster(aes(fill = value), data = eof.dat, na.rm = T) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point() +
scale_fill_brewer(palette = 'RdBu') +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_raster(aes(fill = value), data = eof.dat, na.rm = T) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = white) +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point() +
scale_fill_brewer(palette = 'RdBu') +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_raster(aes(fill = value), data = eof.dat) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point() +
scale_fill_brewer(palette = 'RdBu') +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
eof.dat
swsn.layout
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point(aes(color = Macroregion)) +
scale_node_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point(aes(color = Macroregion)) +
scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
swsn.layout
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point(aes(color = Macro)) +
scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
swsn.layout$Macro %>% unique
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight, color = weight)) +
geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_color_distiller() +
scale_edge_alpha() +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight)) +
geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_alpha(range = c(0,.6)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight), color = grey) +
geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_alpha(range = c(0,.6)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_edge_link(aes(alpha = weight), color = grey) +
geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
stat_binhex(na.rm=TRUE) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
swsn.layout
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_hex(na.rm=TRUE) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_hex(aes(x = x, y = y), na.rm=TRUE) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_bin2d(aes(x = x, y = y), na.rm=TRUE) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_bin2d(aes(x = x, y = y, fill = Macro), na.rm=TRUE) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
swsn.layout$Macro %>% unique %>% length
color.count <- swsn.layout$Macro %>% unique %>% length
color.count <-
getPalette = colorRampPalette(brewer.pal(9, "Set1"))(swsn.layout$Macro %>% unique %>% length)
getPalette = colorRampPalette(brewer.pal(9, "Set1"))(swsn.layout$Macro %>% unique %>% length)
library(RColorBrewer)
getPalette = colorRampPalette(brewer.pal(9, "Set1"))(swsn.layout$Macro %>% unique %>% length)
getPalette = colorRampPalette(brewer.pal(9, "Set1")(swsn.layout$Macro %>% unique %>% length))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))(swsn.layout$Macro %>% unique %>% length))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))((swsn.layout$Macro %>% unique %>% length))
macro.color.ramp <-
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_bin2d(aes(x = x, y = y, fill = Macro), na.rm=TRUE) +
scale_fill_brewer(getPalette) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
#scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
macro.color.ramp <-
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_bin2d(aes(x = x, y = y, fill = Macro), na.rm=TRUE) +
scale_fill_brewer(pal = getPalette) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
#scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
macro.color.ramp <-
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_bin2d(aes(x = x, y = y, fill = Macro), na.rm=TRUE) +
scale_fill_manual(values = getPalette) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
#scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
getPalette
macro.color.ramp <-
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_bin2d(aes(x = x, y = y, fill = Macro), na.rm=TRUE) +
scale_fill_manual(values = getPalette) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
#scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ggraph(swsn.layout) +
geom_polygon(aes(x = long, y = lat, group = region), data = states, color = 'black', fill = NA) +
geom_bin2d(aes(x = x, y = y, fill = Macro), na.rm=TRUE) +
scale_fill_manual(values = getPalette) +
#geom_edge_link(aes(alpha = weight), color = grey) +
#geom_node_point(aes(color = Macro)) +
#scale_color_brewer() +
#scale_edge_color_viridis() +
#scale_edge_alpha(range = c(0,.25)) +
geom_label(x = -106, y = 35, label = 'AD 1200') +
coord_quickmap() +
theme_void() +
theme(legend.position="none")
ad1200
library(gdistance)
elev.agg <- raster('~/Data/NED/swsn_NED_1.tif') %>% aggregate(fact = 10)
levelplot(elev.agg)
plot(elev.agg)
altDiff <- function(x){x[2] - x[1]}
hd <- transition(elev.agg, altDiff, 8, symm=FALSE)
rm(eof.dat, eofdat)
slope <- geoCorrection(hd, type = 'c')
slope <- geoCorrection(hd, type = 'c')
adj <- adjacent(elev.agg, cells=1:ncell(elev.agg), pairs=TRUE, directions=8)
speed <- slope
speed[adj] <- 6 * exp(-3.5 * abs(slope[adj] + 0.05))
Conductance <- geoCorrection(speed, type = 'c')
rm(slope, hd, adj, speed)
el <- get.edgelist(ad1200)
rm(slope, hd, adj, speed, elev.agg)
V(ad1200)$lon
V(ad1200)$x
V(ad1200)
ad1200
ad1200.pts
swsn.pts
